(function(){"use strict";self.onmessage=async function(O){const{imageSrc:S,width:a,height:s,barHeight:l,barColor:m,bgMode:p,cornerRadius:R,squircle:q,centerCornerRadius:P,shadowBlur:z,shadowColor:w,shadowOpacity:C,centerScale:I,centerBgColor:B}=O.data;try{const $=await(await fetch(S)).blob(),T=await createImageBitmap($);(!self.canvas||self.canvas.width!==a||self.canvas.height!==s)&&(self.canvas=new OffscreenCanvas(a,s));const M=self.canvas,e=M.getContext("2d");if(e.clearRect(0,0,a,s),p==="Stretch")e.drawImage(T,0,0,a,s);else if(p==="Center"){e.fillStyle=B,e.fillRect(0,0,a,s);const g=T.width*I,d=T.height*I,u=(a-g)/2,v=(s-d)/2;if(C>0){const b=parseInt(w.slice(1,3),16),i=parseInt(w.slice(3,5),16),t=parseInt(w.slice(5,7),16);e.shadowColor=`rgba(${b}, ${i}, ${t}, ${C})`,e.shadowBlur=z,e.shadowOffsetX=2,e.shadowOffsetY=2}if(P>0){let b=function(i,t,n,f,h,r){i.beginPath(),i.moveTo(t+r,n),i.lineTo(t+f-r,n),i.quadraticCurveTo(t+f,n,t+f,n+r),i.lineTo(t+f,n+h-r),i.quadraticCurveTo(t+f,n+h,t+f-r,n+h),i.lineTo(t+r,n+h),i.quadraticCurveTo(t,n+h,t,n+h-r),i.lineTo(t,n+r),i.quadraticCurveTo(t,n,t+r,n),i.closePath()};C>0&&(e.fillStyle=B,b(e,u,v,g,d,P),e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.save(),b(e,u,v,g,d,P),e.clip(),e.drawImage(T,u,v,g,d),e.restore()}else e.drawImage(T,u,v,g,d);e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}e.fillStyle=m,e.fillRect(0,0,a,l),e.fillStyle=m;const o=R,c=.45;q?(e.beginPath(),e.moveTo(a,s),e.lineTo(a,s-o),e.bezierCurveTo(a,s-o*(1-c),a-o*(1-c),s,a-o,s),e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,s),e.lineTo(0,s-o),e.bezierCurveTo(0,s-o*(1-c),o*(1-c),s,o,s),e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,l),e.lineTo(0,l+o),e.bezierCurveTo(0,l+o*(1-c),o*(1-c),l,o,l),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,l),e.lineTo(a,l+o),e.bezierCurveTo(a,l+o*(1-c),a-o*(1-c),l,a-o,l),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(0,l),e.lineTo(o,l),e.arc(o,l+o,o,-Math.PI/2,Math.PI,!0),e.lineTo(0,l+o),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,l),e.lineTo(a-o,l),e.arc(a-o,l+o,o,-Math.PI/2,0,!1),e.lineTo(a,l+o),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,s-o),e.lineTo(a,s),e.lineTo(a-o,s),e.arcTo(a,s,a,s-o,o),e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,s-o),e.lineTo(0,s),e.lineTo(o,s),e.arc(o,s-o,o,Math.PI/2,Math.PI,!1),e.closePath(),e.fill());const X=await M.convertToBlob();self.postMessage(X)}catch{self.postMessage("error")}}})();
